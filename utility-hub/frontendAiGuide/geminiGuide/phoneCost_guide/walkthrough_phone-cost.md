# 휴대폰 비용 계산기 (Phone Cost Calculator) 구현 보고서

## 1. 개요
퍼블렉시티(Perplexity) 팀의 설계 사양서에 기반하여, 통신사 약정(Carrier)과 자급제+알뜰폰(MVNO)의 24개월 총 비용을 비교하는 계산기를 구현했습니다.

## 2. 구현된 기능
### 📱 UI 컴포넌트 & UX 개선
- **Glassmorphism 디자인**: 기존 프로젝트의 스타일을 유지하는 모던한 카드형 UI.
- **반응형 레이아웃**: PC(2열), 모바일(1열) 자동 최적화.
- **다이내믹 폼**: 통신사 부가서비스를 자유롭게 추가/삭제 가능 (삭제 버튼 아이콘 개선).
- **편의 기능**:
  - **대시보드 바로가기**: 메인 홈 화면(`Dashboard.tsx`)에 계산기 진입 카드 추가.
  - **한글 금액 표기**: 200만원 이상의 큰 금액을 쉽게 읽을 수 있도록 "207만 1,200원" 형태의 포맷팅 제공.
  - **상세 계산식 노출**: 최종 결과 하단에 어떤 항목들이 합산되었는지 수식(Formula) 형태로 투명하게 공개.

### 🧮 핵심 로직 (`usePhoneCost` Hook)
- **비용 계산**:
  - 통신사: (공시/선약 할인 반영 기기값) + (고가 요금제 * M개월) + (저가 요금제 * N개월) + 부가서비스 총액
  - 자급제: (자급제 기기값) + (알뜰 요금제 * 24개월)
- **부가세(VAT) 처리**:
  - 사용자 피드백을 반영하여 통신사 약정과 알뜰폰 요금제의 **부가세(10%) 포함 여부를 각각 개별적으로 설정**할 수 있는 토글 구현.
  - 토글 ON 시 월 요금에 1.1배를 적용하여 계산하며, UI에 "(*계산 시 1.1배 적용)" 안내 표시.
- **비교 분석**: 두 플랜의 차액을 계산하여 더 저렴한 쪽을 하이라이트 표시하고 차액을 시각적으로 강조.

### 🛡️ 검증 및 보안 (Validation)
- **입력값 검증**: 음수 입력 방지, 약정 기간 합계(24개월) 검증, 부가서비스 기간 상한(36개월) 제한.
- **에러 피드백**: 잘못된 입력 필드 하단에 즉시 에러 메시지(빨간색 텍스트) 표시.
- **데이터 지속성**: `localStorage`를 사용하여 페이지 새로고침 후에도 입력값 자동 복원 (VAT 설정 포함).

## 3. 파일 구조
- `PhoneCost.tsx`: 메인 페이지 (아이콘 및 타이틀 개선)
- `components/`
  - `CarrierPlanForm.tsx`: 통신사 입력 폼 (VAT 개별 토글, 다크모드 최적화)
  - `MvnoPlanForm.tsx`: 알뜰폰 입력 폼 (VAT 개별 토글, 레이아웃 일관성 확보)
  - `ComparisonResult.tsx`: 결과 표시 카드 (한글 단위 표기, 계산식 표시)
- `hooks/usePhoneCost.ts`: 상태 관리(Reducer), 로컬스토리지 연동 (계산/검증 로직은 utils로 위임)
- `utils/`:
  - `calculators.ts`: 순수 함수 기반 비용 계산 로직
  - `validators.ts`: 입력값 검증 로직
  - `formatters.ts`: 금액 포맷팅 유틸리티
- `PhoneCost.test.ts.skip`: 테스트 케이스 (현재 비활성화됨)

## 6. 리팩토링 및 고도화 (by Claude Team)
Gemini 팀의 1차 구현 이후, Claude 팀과의 협업을 통해 코드 품질을 한 단계 높였습니다.
- **구조 개선**: 비대한 Hook(`usePhoneCost`)에서 계산(`calculators`), 검증(`validators`), 포맷팅(`formatters`) 로직을 별도 유틸리티로 분리하여 역할(Concern)을 명확히 했습니다.
- **안정성 강화**: `types.ts`에서 검증 에러 키(`ValidationErrorKey`)를 명시적 유니온 타입으로 정의하여 타입 안정성을 확보했습니다.
- **접근성(A11y) 향상**: 토글 스위치와 입력 필드에 `aria-label`, `role="switch"` 등의 속성을 추가하여 스크린 리더 호환성을 높였습니다.
- **유지보수성**: 하드코딩된 값들을 `constants.ts`로 통합 관리하여 변경에 유연하게 대처할 수 있도록 개선했습니다.

## 7. 결론 및 향후 계획
- 사용자의 요청을 반영하여 단순 계산기를 넘어선 **사용자 친화적이고 직관적인 도구**로 완성되었습니다.
- 리팩토링을 통해 코드의 견고함과 유지보수성이 확보되었습니다.
- 추후 테스트 환경(Vitest)이 완비되면 `.skip` 처리된 테스트 파일을 활성화하여 자동화 테스트를 수행할 수 있습니다.
