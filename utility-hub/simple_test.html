<!DOCTYPE html>
<html lang="ko">

<head>
      <meta charset="UTF-8">
      <title>Markdown Test</title>
      <style>
            body {
                  font-family: sans-serif;
                  padding: 20px;
                  max-width: 1200px;
                  margin: 0 auto;
            }

            .container {
                  display: flex;
                  gap: 20px;
            }

            .box {
                  flex: 1;
                  display: flex;
                  flex-direction: column;
            }

            textarea {
                  height: 300px;
                  padding: 10px;
                  border-radius: 5px;
                  border: 1px solid #ccc;
                  font-size: 14px;
            }

            #preview {
                  height: 300px;
                  border: 1px solid #ccc;
                  padding: 10px;
                  overflow-y: auto;
                  background: #fff;
                  border-radius: 5px;
            }

            button {
                  margin: 10px 0;
                  padding: 12px;
                  cursor: pointer;
                  background: #007bff;
                  color: white;
                  border: none;
                  border-radius: 5px;
                  font-weight: bold;
                  font-size: 16px;
                  transition: background 0.2s;
            }

            button:hover {
                  background: #0056b3;
            }

            pre {
                  white-space: pre-wrap;
                  background: #eee;
                  padding: 15px;
                  border-radius: 5px;
                  border: 1px solid #ddd;
            }

            .options {
                  margin-bottom: 20px;
                  padding: 10px;
                  background: #f8f9fa;
                  border-radius: 5px;
            }

            label {
                  margin-right: 15px;
                  cursor: pointer;
            }
      </style>
      <!-- Marked.js: ë§ˆí¬ë‹¤ìš´ì„ HTMLë¡œ ë³€í™˜í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
      <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>
      <h1>ğŸ“ Text to Markdown Tester</h1>
      <div class="options">
            <label><input type="checkbox" id="autoHeading" checked> Auto Heading (# ì œëª©)</label>
            <label><input type="checkbox" id="autoList" checked> Auto List (- ë¦¬ìŠ¤íŠ¸)</label>
            <hr style="margin: 10px 0; border: 0; border-top: 1px solid #ddd;">
            <strong>Persona:</strong>
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 5px;">
                  <label><input type="radio" name="persona" value="STANDARD" checked> ğŸ“„ STANDARD (í‘œì¤€ ë§ˆí¬ë‹¤ìš´ - ì´ëª¨ì§€ ì—†ìŒ,
                        ì¤‘ë¦½ì )</label>
                  <label><input type="radio" name="persona" value="SMART"> ğŸ¤– SMART (ì¹œì ˆí•œ AI ë¹„ì„œ - ì´ëª¨ì§€, ìš”ì•½ í¬í•¨)</label>
                  <label><input type="radio" name="persona" value="DRY"> ğŸ˜ DRY (ê±´ì¡°í•œ íŒ©íŠ¸ ì¤‘ì‹¬ - ëª…ì‚¬í˜• ì¢…ê²°)</label>
                  <label><input type="radio" name="persona" value="ACADEMIC"> ğŸ“ ACADEMIC (í•™ìˆ ì  - ì¸ìš© ìŠ¤íƒ€ì¼, ì„¹ì…˜ ë²ˆí˜¸)</label>
                  <label><input type="radio" name="persona" value="CASUAL"> ğŸˆ CASUAL (ìºì£¼ì–¼ - í¸ì•ˆí•œ ë§íˆ¬, ì´ëª¨ì§€ ë‹¤ìˆ˜)</label>
                  <label><input type="radio" name="persona" value="TECHNICAL"> ğŸ’» TECHNICAL (ê¸°ìˆ  ë¬¸ì„œ - ì½”ë“œ ë¸”ë¡, êµ¬ì¡°í™”)</label>
                  <label><input type="radio" name="persona" value="CREATIVE"> ğŸ¨ CREATIVE (ì°½ì˜ì  - ê°ì„±ì  í‘œí˜„, ë¹„ìœ )</label>
                  <label><input type="radio" name="persona" value="MINIMAL"> âš¡ MINIMAL (ë¯¸ë‹ˆë©€ - í•µì‹¬ë§Œ, ë¶ˆë › í¬ì¸íŠ¸)</label>
                  <label><input type="radio" name="persona" value="DETAILED"> ğŸ” DETAILED (ìƒì„¸ - ë‹¨ê³„ë³„ ì„¤ëª…, ì˜ˆì‹œ)</label>
                  <label><input type="radio" name="persona" value="BUSINESS"> ğŸ’¼ BUSINESS (ë¹„ì¦ˆë‹ˆìŠ¤ - ì „ë¬¸ì , ì•¡ì…˜ ì•„ì´í…œ)</label>
            </div>
      </div>

      <div class="container">
            <div class="box">
                  <h3>ğŸ“¥ Input Results</h3>
                  <textarea id="inputText" placeholder="í…ŒìŠ¤íŠ¸í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                  <div style="margin-bottom: 10px;">
                        <button onclick="fillSample()" style="background:#28a745; margin-right: 5px;">ğŸ“ ì˜ˆì‹œ ë°ì´í„° ì±„ìš°ê¸°
                              (10ì¤„)</button>
                        <button onclick="convert()">ë³€í™˜í•˜ê¸° (Convert)</button>
                  </div>
            </div>
            <div class="box">
                  <h3>ğŸ¨ Rendered Result (HTML)</h3>
                  <div id="preview">ì—¬ê¸°ì— ë³€í™˜ëœ ê²°ê³¼ê°€ ë³´ì—¬ì§‘ë‹ˆë‹¤.</div>
            </div>
      </div>

      <h3>ğŸ” Raw Response (ì‹¤ì œ \n ì ìš© í™•ì¸)</h3>
      <pre id="rawOutput">API ì‘ë‹µ ì›ë³¸ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</pre>

      <script>
            async function convert() {
                  const text = document.getElementById('inputText').value;
                  const autoHeading = document.getElementById('autoHeading').checked;
                  const autoList = document.getElementById('autoList').checked;
                  const preview = document.getElementById('preview');
                  const rawOutput = document.getElementById('rawOutput');

                  if (!text.trim()) {
                        alert("í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                        return;
                  }

                  preview.innerHTML = "<p style='color:gray'>ë³€í™˜ ì¤‘ì…ë‹ˆë‹¤...</p>";

                  try {
                        // 1. Send Request to Backend
                        const response = await fetch('http://localhost:8080/api/text-to-md', {
                              method: 'POST',
                              headers: { 'Content-Type': 'application/json' },
                              body: JSON.stringify({ rawText: text, autoHeading, autoList })
                        });

                        if (!response.ok) {
                              throw new Error('HTTP Error ' + response.status);
                        }

                        const data = await response.json();

                        // 2. Raw Markdown í™•ì¸ (ì¤„ë°”ê¿ˆì´ ì ìš©ëœ í…ìŠ¤íŠ¸ ê·¸ëŒ€ë¡œ ì¶œë ¥)
                        // <pre> íƒœê·¸ ì•ˆì—ì„œëŠ” \nì´ ì‹¤ì œ ì¤„ë°”ê¿ˆìœ¼ë¡œ ë³´ì…ë‹ˆë‹¤.
                        rawOutput.textContent = data.markdownText;

                        // 3. Rendered HTML í™•ì¸ (marked.js ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©)
                        // ë§ˆí¬ë‹¤ìš´ ë¬¸ë²•(#, -, **)ì´ ì‹¤ì œ HTML(h1, li, strong)ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.
                        preview.innerHTML = marked.parse(data.markdownText);

                  } catch (e) {
                        alert('ì—ëŸ¬ ë°œìƒ: ' + e);
                        preview.innerHTML = "<p style='color:red'>ì‹¤íŒ¨</p>";
                        rawOutput.textContent = e;
                  }
            }
      </script>
</body>

</html>